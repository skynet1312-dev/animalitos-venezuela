<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datos Animalitos Venezuela v2.0</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; -webkit-tap-highlight-color: transparent; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        .anim-pop { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 to-purple-800 min-h-screen p-2 md:p-4 text-slate-800">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- DATOS BASE ---
        const ANIMALITOS = [
            { id: '0', name: 'Delf칤n', color: 'bg-blue-500' },
            { id: '00', name: 'Ballena', color: 'bg-pink-600' },
            { id: '01', name: 'Carnero', color: 'bg-amber-600' },
            { id: '02', name: 'Toro', color: 'bg-red-700' },
            { id: '03', name: 'Ciempi칠s', color: 'bg-gray-600' },
            { id: '04', name: 'Alacr치n', color: 'bg-yellow-600' },
            { id: '05', name: 'Le칩n', color: 'bg-orange-500' },
            { id: '06', name: 'Rana', color: 'bg-green-600' },
            { id: '07', name: 'Perico', color: 'bg-green-500' },
            { id: '08', name: 'Rat칩n', color: 'bg-gray-500' },
            { id: '09', name: '츼guila', color: 'bg-yellow-700' },
            { id: '10', name: 'Tigre', color: 'bg-orange-600' },
            { id: '11', name: 'Gato', color: 'bg-gray-700' },
            { id: '12', name: 'Caballo', color: 'bg-amber-700' },
            { id: '13', name: 'Mono', color: 'bg-amber-500' },
            { id: '14', name: 'Paloma', color: 'bg-gray-400' },
            { id: '15', name: 'Zorro', color: 'bg-orange-700' },
            { id: '16', name: 'Oso', color: 'bg-amber-800' },
            { id: '17', name: 'Pavo', color: 'bg-red-600' },
            { id: '18', name: 'Burro', color: 'bg-gray-600' },
            { id: '19', name: 'Chivo', color: 'bg-amber-600' },
            { id: '20', name: 'Cochino', color: 'bg-pink-400' },
            { id: '21', name: 'Gallo', color: 'bg-red-500' },
            { id: '22', name: 'Camello', color: 'bg-yellow-600' },
            { id: '23', name: 'Cebra', color: 'bg-gray-800' },
            { id: '24', name: 'Iguana', color: 'bg-green-700' },
            { id: '25', name: 'Gallina', color: 'bg-red-400' },
            { id: '26', name: 'Vaca', color: 'bg-amber-500' },
            { id: '27', name: 'Perro', color: 'bg-amber-700' },
            { id: '28', name: 'Zamuro', color: 'bg-gray-900' },
            { id: '29', name: 'Elefante', color: 'bg-gray-600' },
            { id: '30', name: 'Caim치n', color: 'bg-green-800' },
            { id: '31', name: 'Lapa', color: 'bg-blue-600' },
            { id: '32', name: 'Ardilla', color: 'bg-orange-400' },
            { id: '33', name: 'Pescado', color: 'bg-blue-400' },
            { id: '34', name: 'Venado', color: 'bg-amber-600' },
            { id: '35', name: 'Jirafa', color: 'bg-yellow-500' },
            { id: '36', name: 'Culebra', color: 'bg-green-600' },
        ];

        const HORARIOS_MANANA = ["08:00 AM", "09:00 AM", "10:00 AM", "11:00 AM", "12:00 PM"];
        const HORARIOS_TARDE = ["01:00 PM", "02:00 PM", "03:00 PM", "04:00 PM", "05:00 PM", "06:00 PM", "07:00 PM"];
        const HORARIOS = [...HORARIOS_MANANA, ...HORARIOS_TARDE];
        const SORTEOS = ["Lottoactivo", "La Granjita"];

        // --- COMPONENTES AUXILIARES ---

        const AnimalBadge = ({ number, showName = false, size = "md", extraClass = "" }) => {
            const animal = ANIMALITOS.find(a => a.id === number) || ANIMALITOS[0];
            const sizeClasses = size === "lg" ? "w-16 h-16 text-2xl" : (size === "sm" ? "w-8 h-8 text-xs" : "w-12 h-12 text-lg");
            
            return (
                <div className={`flex flex-col items-center anim-pop ${extraClass}`}>
                    <div className={`${animal.color} ${sizeClasses} rounded-full flex items-center justify-center text-white font-bold shadow-md border-2 border-white`}>
                        {animal.id}
                    </div>
                    {showName && <span className="text-[10px] md:text-xs font-medium mt-1 text-gray-700 text-center leading-tight">{animal.name}</span>}
                </div>
            );
        };

        // --- PANTALLAS ---

        // 1. PRON칍STICOS ALEATORIOS
        const RandomForecast = () => {
            const [sorteo, setSorteo] = useState(SORTEOS[0]);
            const [cantidad, setCantidad] = useState(3);
            const [resultados, setResultados] = useState([]);

            const generar = () => {
                const nuevos = [];
                for(let i=0; i<cantidad; i++) {
                    const randomIndex = Math.floor(Math.random() * ANIMALITOS.length);
                    nuevos.push(ANIMALITOS[randomIndex]);
                }
                setResultados(nuevos);
            };

            return (
                <div className="space-y-6">
                    <h2 className="text-xl font-bold text-gray-800 flex items-center"><span className="text-2xl mr-2">游</span> Pron칩stico Aleatorio</h2>
                    <div className="bg-gray-50 p-4 rounded-xl shadow-inner">
                        <label className="block text-sm font-medium text-gray-700 mb-2">Sorteo</label>
                        <div className="flex space-x-2 mb-4">
                            {SORTEOS.map(s => (
                                <button key={s} onClick={() => setSorteo(s)} 
                                    className={`flex-1 py-2 px-4 rounded-lg text-sm font-bold transition-colors ${sorteo === s ? 'bg-blue-600 text-white shadow-lg' : 'bg-white text-gray-600 border'}`}>
                                    {s}
                                </button>
                            ))}
                        </div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">Cantidad: {cantidad}</label>
                        <input type="range" min="1" max="10" value={cantidad} onChange={(e) => setCantidad(parseInt(e.target.value))}
                            className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600" />
                    </div>
                    <button onClick={generar} className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg transform active:scale-95 transition-transform text-lg">
                        GENERAR PRON칍STICO
                    </button>
                    {resultados.length > 0 && (
                        <div className="grid grid-cols-4 gap-4 mt-6 p-4 bg-white rounded-xl shadow border border-gray-100">
                            {resultados.map((r, idx) => <AnimalBadge key={`${r.id}-${idx}`} number={r.id} showName={true} />)}
                        </div>
                    )}
                </div>
            );
        };

        // 2. NUEVA FUNCIONALIDAD: PROYECCI칍N MATEM츼TICA TARDE
        const PatternAnalyzer = ({ db }) => {
            const [sorteo, setSorteo] = useState(SORTEOS[0]);
            const [diasAtras, setDiasAtras] = useState(15);
            const [analysis, setAnalysis] = useState(null);

            const analizar = () => {
                const hoy = new Date().toISOString().split('T')[0];
                
                // 1. Obtener resultados de HOY en la ma침ana (8AM - 12PM)
                const resultadosHoyManana = db.filter(r => 
                    r.fecha === hoy && 
                    r.sorteo === sorteo && 
                    HORARIOS_MANANA.includes(r.horario)
                ).map(r => r.numero);

                if (resultadosHoyManana.length === 0) {
                    setAnalysis({ error: "No hay resultados cargados para hoy en la ma침ana (8 AM - 12 PM). Carga datos primero." });
                    return;
                }

                // 2. Buscar en el historial (5 a 15 d칤as atr치s)
                const fechaLimite = new Date();
                fechaLimite.setDate(fechaLimite.getDate() - diasAtras);
                
                const historialRelevante = db.filter(r => 
                    r.fecha !== hoy && // No incluir hoy
                    r.fecha >= fechaLimite.toISOString().split('T')[0] &&
                    r.sorteo === sorteo
                );

                // Agrupar historial por fecha
                const historialPorDia
